/********************************************************************************** 
 * USE OF IERS SUBROUTINE HARDISP: computes tidal displacements, using an         *
 *                                 expanded set of tidal constituentsomputes      *
 *                                                                                *
 *  Test case: run original HARDISP program from IERS                             *                                     *
 *  HARDISP 2009 176 0 0 0 10 3600 < ocean_load_test.blq                          *
 *        0.003513     -0.001893     -0.001513                                    *
 *        0.003248     -0.001620     -0.001012                                    *
 *        0.002079     -0.001068     -0.000319                                    *
 *        0.000498     -0.000374      0.000328                                    *
 *       -0.000913      0.000298      0.000712                                    *
 *       -0.001639      0.000800      0.000695                                    *
 *       -0.001369      0.001032      0.000254                                    *
 *       -0.000084      0.000966     -0.000510                                    *
 *        0.001935      0.000654     -0.001401                                    *
 *        0.004177      0.000208     -0.002171                                    *
 *                                                                                *
 *  with ocean loading coefficients for ONSALA                                    *
 *   .00352 .00123 .00080 .00032 .00187 .00112 .00063 .00003 .00082 .00044 .00037 *
 *   .00144 .00035 .00035 .00008 .00053 .00049 .00018 .00009 .00012 .00005 .00006 *
 *   .00086 .00023 .00023 .00006 .00029 .00028 .00010 .00007 .00004 .00002 .00001 *
 *    -64.7  -52.0  -96.2  -55.2  -58.8 -151.4  -65.6 -138.1    8.4    5.2    2.1 *
 *     85.5  114.5   56.5  113.6   99.4   19.1   94.1  -10.4 -167.4 -170.0 -177.7 *
 *    109.5  147.0   92.7  148.8   50.5  -55.1   36.4 -170.4  -15.0    2.3    5.2 *
 *                                                                                *
 *                                                                                *
 * 2014-12-08 - TA                                                                *
 *********************************************************************************/
#include<iostream> 
#include<vector> 
#include"iers_wrapper.h"


using namespace std;
using namespace iers;
			  
int main( const int argc, const char **argv )
{
   vector<double> disp( 3,0.0 );
   vector<float> amp = { .00352, .00144,.00086, 
                         .00123, .00035,.00023, 
                         .00080, .00035,.00023, 
                         .00032, .00008,.00006, 
                         .00187, .00053,.00029, 
                         .00112, .00049,.00028, 
                         .00063, .00018,.00010, 
                         .00003, .00009,.00007, 
                         .00082, .00012,.00004, 
                         .00044, .00005,.00002, 
                         .00037, .00006,.00001 };
  
   vector<float> pha = {  -64.7,   85.5,  109.5,  
                          -52.0,  114.5,  147.0,   
                          -96.2,   56.5,   92.7,  
                          -55.2,  113.6,  148.8,   
                          -58.8,   99.4,   50.5,  
                         -151.4,   19.1,  -55.1,   
                          -65.6,   94.1,   36.4, 
                         -138.1,  -10.4, -170.4,  
                            8.4, -167.4,  -15.0,    
                            5.2, -170.0,    2.3,    
                            2.1, -177.7,    5.2 };
   
   vector<int> epoch = { 2009, 176, 0, 0, 0 };

   // test case 
   cout << "test case 1" << endl;
   cout << "dU   dS   dW" << endl;
   for( int i=0; i<10; ++i )
   {
      hardisp_( &epoch[0], &amp[0], &pha[0], &disp[0] );
  
      cout << disp[0] << ", " << disp[1] << ", " << disp[2] << endl;
      epoch.at(2)++;
   }

   return 0;
}
